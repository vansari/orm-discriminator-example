CREATE TABLE public.status (
    id integer GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name varchar(255)
);

CREATE TABLE public.main (
    id integer GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    firstname varchar(255),
    surname varchar(255),
    company varchar(255),
    status integer NOT NULL REFERENCES public.status (id),
    is_broker integer GENERATED ALWAYS AS (CASE WHEN status IN (1, 2) THEN 1 ELSE 0 END) STORED
);

INSERT INTO public.status (id, name)
VALUES (1, 'Broker'), (2, 'Subbroker'), (3, 'Customer'), (4, 'Ex-Customer');